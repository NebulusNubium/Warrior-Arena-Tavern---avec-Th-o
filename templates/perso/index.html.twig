{% extends 'base.html.twig' %}

{% block title %}Personnages - Warrior Arena Tavern{% endblock %}

{% block body %}
<img src="{{ asset('bottom.png') }}" alt="Décoration" class="form-page-decoration">
<div class="form-page">
    {% if canAddCharacter %}
        <h1 class="form-page-title">Ajouter un personnage</h1>

        <div class="character-wrapper">
        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        {% if characterForm %}
            {{ form_start(characterForm, {'attr': {'enctype': 'multipart/form-data'}}) }}
                <div class="form-group">
                    {{ form_label(characterForm.name) }}
                    {{ form_widget(characterForm.name) }}
                    {{ form_errors(characterForm.name) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.HP) }}
                    {{ form_widget(characterForm.HP) }}
                    {{ form_errors(characterForm.HP) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.power) }}
                    {{ form_widget(characterForm.power) }}
                    {{ form_errors(characterForm.power) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.defense) }}
                    {{ form_widget(characterForm.defense) }}
                    {{ form_errors(characterForm.defense) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.description) }}
                    {{ form_widget(characterForm.description) }}
                    {{ form_errors(characterForm.description) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.imageFile) }}
                    {{ form_widget(characterForm.imageFile) }}
                    {{ form_errors(characterForm.imageFile) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.roleName) }}
                    {{ form_widget(characterForm.roleName) }}
                    {{ form_errors(characterForm.roleName) }}
                </div>
                
                <div class="form-group">
                    {{ form_label(characterForm.typeName) }}
                    {{ form_widget(characterForm.typeName) }}
                    {{ form_errors(characterForm.typeName) }}
                </div>
                
                <button type="submit" class="btn btn-primary">Ajouter le personnage</button>
            {{ form_end(characterForm) }}
        {% endif %}
        </div>
    {% endif %}

<div class="characters-list-section">
    <h2>Liste des personnages</h2>
    <div class="character-list">
        {% for character in characters %}
            <div class="character-item">
                {% if character.imageName %}
                    <img src="{{ asset('uploads/images/' ~ character.imageName) }}" alt="{{ character.name }}" class="character-avatar">
                {% else %}
                    <div class="character-avatar placeholder">?</div>
                {% endif %}
                <div class="character-info">
                    <h3>{{ character.name }}</h3>
                    <div class="character-stats">
                        <div class="stat">
                            <span class="stat-label">PV:</span>
                            <span class="stat-value">{{ character.HP }}</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Puissance:</span>
                            <span class="stat-value">{{ character.power }}</span>
                        </div>
                        <div class="stat">
                            <span class="stat-label">Défense:</span>
                            <span class="stat-value">{{ character.defense }}</span>
                        </div>
                    </div>
                    {% if character.description %}
                        <div class="character-description">{{ character.description }}</div>
                    {% endif %}
                    <div class="character-tags">
                        {% if character.role %}
                            <div class="tag-group">
                                <span class="tag-label">Rôle :</span>
                                <span class="badge bg-secondary">{{ character.role.name }}</span>
                            </div>
                        {% endif %}
                        {% if character.type %}
                            <div class="tag-group">
                                <span class="tag-label">Type :</span>
                                <span class="badge bg-info">{{ character.type.name }}</span>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% else %}
            <div class="no-characters">Aucun personnage trouvé.</div>
        {% endfor %}
    </div>
</div>
</div>
{% endblock %}
